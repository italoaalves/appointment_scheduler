<div class="space-y-4">
  <header>
    <h1 class="text-2xl font-semibold tracking-tight text-slate-900">
      <%= t("space.personalized_scheduling_links.edit.title") %>
    </h1>
    <p class="mt-1 text-sm text-slate-600">
      <%= t("space.personalized_scheduling_links.edit.subtitle") %>
    </p>
  </header>

  <div class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
    <%= form_with model: @personalized_link, url: personalized_scheduling_link_path, method: :patch, class: "space-y-4" do |form| %>
      <%= render "application/shared/error_messages", resource: @personalized_link %>
      <div>
        <%= form.label :slug, t("space.personalized_scheduling_links.edit.slug_label"), class: "block text-sm font-medium text-slate-700" %>
        <p class="mt-0.5 text-xs text-slate-500">
          <% changes_left = 3 - current_tenant.personalized_slug_changes_count %>
          <%= changes_left > 0 ? t("space.personalized_scheduling_links.edit.slug_hint", count: changes_left, days: 14) : t("space.personalized_scheduling_links.edit.slug_no_changes_left") %>
        </p>
        <div class="mt-1 flex items-center gap-2">
          <span class="text-sm text-slate-500"><%= root_url.gsub(/\/$/, "") %>/book/s/</span>
          <%= form.text_field :slug,
                              readonly: changes_left <= 0,
                              placeholder: t("space.personalized_scheduling_links.edit.slug_placeholder"),
                              class: "flex-1 rounded-md border border-slate-300 px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500 #{'bg-slate-100 cursor-not-allowed' if changes_left <= 0}" %>
        </div>
      </div>
      <div class="flex flex-wrap gap-3">
        <% if changes_left > 0 %>
          <%= form.submit t("space.personalized_scheduling_links.edit.submit"),
                        class: button_classes(:primary),
                        data: { turbo_submits_with: t("shared.submitting") } %>
        <% end %>
        <%= link_to t("space.personalized_scheduling_links.edit.cancel"),
                    scheduling_links_path,
                    class: button_classes(:secondary) %>
      </div>
    <% end %>
  </div>

  <div class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
    <h2 class="text-sm font-semibold text-slate-800"><%= t("space.personalized_scheduling_links.edit.remove_title") %></h2>
    <p class="mt-1 text-xs text-slate-600"><%= t("space.personalized_scheduling_links.edit.remove_hint") %></p>
    <%= button_to t("space.personalized_scheduling_links.edit.remove"),
                  personalized_scheduling_link_path,
                  method: :delete,
                  data: { turbo_confirm: t("space.personalized_scheduling_links.edit.remove_confirm"), turbo_submits_with: t("shared.removing") },
                  class: "mt-3 #{button_classes(:destructive)}" %>
  </div>
</div>
