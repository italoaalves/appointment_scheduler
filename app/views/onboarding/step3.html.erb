<%= render "onboarding/progress", current_step: 3 %>
<div class="mx-auto max-w-lg space-y-6">
  <h1 class="text-2xl font-semibold text-slate-900">
    <%= t("onboarding.step3.title") %>
  </h1>

  <div class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
    <p class="text-lg font-bold text-slate-900"><%= current_tenant.name %></p>
    <span class="mt-2 inline-block rounded-full bg-emerald-100 px-2.5 py-0.5 text-xs font-medium text-emerald-800">
      <%= t("onboarding.step3.preview.available") %>
    </span>
    <% if current_tenant.business_hours.present? %>
      <p class="mt-2 text-sm text-slate-600"><%= current_tenant.business_hours %></p>
    <% end %>
    <p class="mt-1 text-sm text-slate-500">
      <%= t("onboarding.step3.preview.duration", minutes: current_tenant.slot_duration_minutes) %>
    </p>
  </div>

  <div data-controller="clipboard" class="space-y-3">
    <label class="<%= form_label_classes %>"><%= t("onboarding.step3.url_label") %></label>
    <div class="flex flex-wrap items-center gap-2">
      <code data-clipboard-target="source"
            class="block flex-1 min-w-0 rounded-md border border-slate-300 bg-slate-50 px-3 py-2 text-sm text-slate-800">
        <%= @booking_url %>
      </code>
      <button type="button"
              data-action="click->clipboard#copy"
              class="<%= button_classes(:primary) %>">
        <%= t("onboarding.step3.copy_link") %>
      </button>
      <span data-clipboard-target="feedback"
            class="hidden text-sm font-medium text-emerald-600">
        <%= t("onboarding.step3.copied") %>
      </span>
    </div>
    <div class="flex flex-wrap gap-2">
      <a href="https://wa.me/?text=<%= ERB::Util.url_encode(t("onboarding.step3.share_whatsapp_message", name: current_tenant.name, url: @booking_url)) %>"
         target="_blank"
         rel="noopener noreferrer"
         class="<%= button_classes(:success) %>">
        <%= t("onboarding.step3.share_whatsapp") %>
      </a>
      <%= link_to t("onboarding.step3.open_preview"),
                  book_by_slug_path(slug: @personalized_link.slug),
                  target: "_blank",
                  rel: "noopener noreferrer",
                  class: button_classes(:secondary) %>
    </div>
  </div>

  <div class="rounded-md border border-slate-200 bg-slate-50 p-4">
    <p class="font-medium text-slate-900"><%= t("onboarding.step3.trial_active") %></p>
    <ul class="mt-2 list-disc list-inside space-y-1 text-sm text-slate-600">
      <li><%= t("onboarding.step3.trial_features.team") %></li>
      <li><%= t("onboarding.step3.trial_features.personalized_page") %></li>
      <li><%= t("onboarding.step3.trial_features.whatsapp") %></li>
    </ul>
    <p class="mt-3 text-xs text-slate-500"><%= t("onboarding.step3.plan_change_hint") %></p>
  </div>

  <div class="flex flex-wrap items-center gap-4">
    <%= button_to t("onboarding.step3.go_to_dashboard"),
                 update_step3_onboarding_wizard_path,
                 method: :patch,
                 class: button_classes(:primary) %>
  </div>
</div>
