<div class="space-y-6">
  <header class="text-center">
    <h1 class="text-2xl font-semibold tracking-tight text-slate-900">
      <%= @space.name %>
    </h1>
    <% if @space.business_type.present? %>
      <p class="mt-1 text-sm text-slate-600"><%= @space.business_type %></p>
    <% end %>
  </header>

  <%= form_with url: book_path(token: @scheduling_link.token), method: :post, class: "space-y-4", data: { controller: "booking" } do |form| %>
    <div class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
      <h2 class="text-sm font-semibold text-slate-800"><%= t("booking.choose_date") %></h2>
      <div class="mt-2">
        <% today_in_space = Time.current.in_time_zone(@space.timezone.presence || "UTC").to_date %>
        <input type="date"
               name="date"
               id="booking_date"
               min="<%= today_in_space.iso8601 %>"
               max="<%= (today_in_space + 60.days).iso8601 %>"
               value="<%= today_in_space.iso8601 %>"
               class="block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"
               data-booking-target="dateInput"
               data-action="change->booking#loadSlots" />
      </div>
    </div>

    <div class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm"
         data-booking-target="slotsContainer"
         data-loading-text="<%= t("booking.loading_slots") %>"
         data-empty-text="<%= t("booking.no_slots") %>"
         data-choose-text="<%= t("booking.choose_time_prompt") %>">
      <h2 class="text-sm font-semibold text-slate-800"><%= t("booking.choose_time") %></h2>
      <p class="mt-1 text-xs text-slate-500"><%= t("booking.loading_slots") %></p>
      <div class="mt-3 grid grid-cols-2 gap-2 sm:grid-cols-3" data-booking-target="slotsList">
      </div>
    </div>

    <input type="hidden" name="scheduled_at" data-booking-target="scheduledAt" required />

    <div class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
      <h2 class="text-sm font-semibold text-slate-800"><%= t("booking.your_details") %></h2>
      <div class="mt-3 space-y-3">
        <div>
          <label for="client_name" class="block text-sm font-medium text-slate-700"><%= t("booking.name_label") %></label>
          <input type="text" name="client_name" id="client_name" required
                 class="mt-1 block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"
                 placeholder="<%= t("booking.name_placeholder") %>" />
        </div>
        <div>
          <label for="client_phone" class="block text-sm font-medium text-slate-700"><%= t("booking.phone_label") %></label>
          <input type="tel" name="client_phone" id="client_phone"
                 class="mt-1 block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"
                 placeholder="<%= t("booking.phone_placeholder") %>" />
        </div>
        <div>
          <label for="client_email" class="block text-sm font-medium text-slate-700"><%= t("booking.email_label") %></label>
          <input type="email" name="client_email" id="client_email"
                 class="mt-1 block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"
                 placeholder="<%= t("booking.email_placeholder") %>" />
        </div>
        <div>
          <label for="client_address" class="block text-sm font-medium text-slate-700"><%= t("booking.address_label") %></label>
          <input type="text" name="client_address" id="client_address"
                 class="mt-1 block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"
                 placeholder="<%= t("booking.address_placeholder") %>" />
        </div>
      </div>
    </div>

    <div class="flex flex-wrap gap-3">
      <button type="submit" disabled data-booking-target="submitBtn"
              class="inline-flex items-center rounded-md bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-50">
        <%= t("booking.submit") %>
      </button>
    </div>
  <% end %>
</div>

