<div class="space-y-6">
  <%= render "application/shared/page_header", title: t("platform.users.edit.title"), subtitle: t("platform.users.edit.subtitle") %>

  <%= render layout: "application/shared/card" do %>
    <%= form_with model: [:platform, @user], class: "space-y-4" do |form| %>
      <%= render "application/shared/error_messages", resource: @user %>

      <div>
        <%= form.label :email, class: form_label_classes %>
        <%= form.email_field :email,
                             required: true,
                             class: form_input_classes %>
      </div>

      <div>
        <%= form.label :name, class: form_label_classes %>
        <%= form.text_field :name,
                            class: form_input_classes %>
      </div>

      <div>
        <%= form.label :phone_number,
                       t("platform.users.edit.phone_label"),
                       class: form_label_classes %>
        <%= form.telephone_field :phone_number,
                                 class: form_input_classes %>
      </div>

      <div>
        <%= form.label :role, t("platform.users.form.role_label"), class: form_label_classes %>
        <%= form.text_field :role, placeholder: t("platform.users.form.role_placeholder"), class: form_input_classes %>
      </div>

      <div>
        <p class="text-sm font-medium text-slate-700"><%= t("platform.users.form.permissions_label") %></p>
        <%= form.collection_check_boxes :permission_names_param,
                                        PermissionService::ALLOWED_PERMISSIONS.excluding("own_space"),
                                        :to_s,
                                        ->(p) { t("platform.permissions.#{p}") } do |b| %>
          <label class="mt-2 flex items-center gap-2 text-sm">
            <%= b.check_box %>
            <span><%= b.text %></span>
          </label>
        <% end %>
      </div>

      <div>
        <%= form.label :space_id,
                       t("platform.users.edit.space_label"),
                       class: form_label_classes %>
        <%= form.collection_select :space_id,
                                   Space.order(:name),
                                   :id, :name,
                                   { include_blank: t("platform.users.edit.no_space") },
                                   class: form_input_classes %>
      </div>

      <div class="grid gap-4 sm:grid-cols-2">
        <div>
          <%= form.label :password,
                         t("platform.users.edit.password_label"),
                         class: form_label_classes %>
          <%= form.password_field :password,
                                  class: "mt-1 block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500" %>
        </div>
        <div>
          <%= form.label :password_confirmation,
                         t("platform.users.edit.password_confirmation_label"),
                         class: form_label_classes %>
          <%= form.password_field :password_confirmation,
                                  class: "mt-1 block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500" %>
        </div>
      </div>

      <div class="flex flex-wrap gap-3">
        <%= form.submit t("platform.users.edit.submit"),
                        class: button_classes(:primary),
                        data: { turbo_submits_with: t("shared.submitting") } %>
        <%= link_to t("platform.users.edit.back"),
                    platform_user_path(@user, space_id: params[:space_id].presence),
                    class: button_classes(:secondary) %>
        <%= link_to t("platform.users.edit.all_users"),
                    platform_users_path(space_id: params[:space_id].presence),
                    class: button_classes(:secondary) %>
      </div>
    <% end %>
  <% end %>
</div>
